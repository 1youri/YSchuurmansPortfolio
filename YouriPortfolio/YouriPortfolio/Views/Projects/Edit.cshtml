@using YouriPortfolio.Models
@model YouriPortfolio.Models.ViewModels.ProjectViewModel
@{
    ViewBag.Title = "ContentEdit";
}
<head>
    <script src="~/Scripts/jquery.wysibb.min.js"></script>
    <link href="~/Content/wbbtheme.css" rel="stylesheet" />
</head>
<script>
    $(document).ready(function () {
        var wbbOpt = {
            buttons: "bold,italic,underline,|,img,link,code"
        }
        $("#Project_ContentText").wysibb(wbbOpt);
        $("#Project_ShortContent").wysibb(wbbOpt);
    });
</script>

<script type="text/javascript">
    $(function () {
        if (window.FileReader != null) {
            $('#single').hide();
            $('.single').prop('disabled', true);
        } else {
            $('#multiple').hide();
            $('.multiple').prop('disabled', true);
        }
    });
</script>

<br />
<div class="row">
    <div class="ContentBlock">
        <div class="row">
            <h2>Project Edit Page</h2>

            <div class="row text-right col-md-12">
                @Html.ActionLink("Delete", "DeleteProject", new { ID = Model.Project.ID }, new { @class = "btn btn-danger" })
            </div>
            <div class="col-md-8">
                <h3>Project Content</h3>
                @using (Html.BeginForm("Edit", "Projects", FormMethod.Post))
            {
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(model => model.Project.ID)
                    <h4>Title</h4>
                    @Html.EditorFor(model => model.Project.Title)

                    <h4>Short Description</h4>
                    @Html.TextAreaFor(model => model.Project.ShortContent, new { @style = "min-height:100px" })

                    <h4>Full Description</h4>
                    @Html.TextAreaFor(model => model.Project.ContentText, new { @style = "min-height:200px" })
                    <br />
                    <input type="submit" value="Save" class="btn btn-primary" />
                }

            </div>
            <div class="col-md-4">
                @if (Model.Project.ID > 0)
                {
                    <h3>Visual content management</h3>
                    <div class="row">
                        <h4>Upload Visuals</h4>
                        @using (Html.BeginForm("UploadMultiple", "Projects", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.HiddenFor(model => model.Project.ID)
                            <div id="multiple">
                                <input type="file" class="multiple" name="files" multiple />
                            </div>
                                <div id="single">
                                    <input type="file" class="single" name="files" /><br />
                                    <input type="file" class="single" name="files" /><br />
                                    <input type="file" class="single" name="files" /><br />
                                </div>
                                <br />
                                <button class="btn btn-success">Upload</button>
                        }
                        <br />
                        <br />
                        <h4>New Videos</h4>
                        @using (Html.BeginForm("NewVideo", "Projects", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()
                            @Html.HiddenFor(model => model.Project.ID)

                            @Html.TextBoxFor(model => model.PostVideo)

                            <br />
                                <button class="btn btn-success">Upload</button>
                        }

                    </div>

                    <br />
                    <div class="row">

                        @using (Html.BeginForm("DeleteVisuals", "Projects", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.HiddenFor(model => model.Project.ID)
                            <h4>Delete Visuals</h4>
                                <div class="row">
                                    @for (int i = 0; i < Model.Project.Visuals.Count; i++)
                                    {
                                        <div class="col-xs-6 ">
                                            <div class=" text-center VisualBlock">

                                                @Html.HiddenFor(model => model.Project.Visuals[i].ID)
                                                @Html.HiddenFor(model => model.Project.Visuals[i].Location)
                                                @Html.CheckBoxFor(model => model.Project.Visuals[i].Selected)
                                                <br />
                                                @if (Model.Project.Visuals[i].ContentType == Visual.ContentTypes.Photo)
                                                {
                                                    <img src="/uploads/@Model.Project.Visuals[i].Location" />
                                                }
                                                else
                                                {
                                                    <img src="//img.youtube.com/vi/@Model.Project.Visuals[i].Location/sddefault.jpg" />
                                                }
                                            </div>
                                        </div>
                                    }
                                </div>
                                <br />
                                <button class="btn btn-danger">Delete</button>
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>